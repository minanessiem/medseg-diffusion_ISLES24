# DDP 500K-step profile-A config for 4-GPU, global 64 batch training.
# Carries over cluster_1M_sweep architecture/training choices, with:
# - distribution: ddp
# - global train batch size: 64
# - optimizer: adamw_75e5lr_wd00
# - training: 500K steps
# - scheduler: 10K absolute warmup + cosine decay

defaults:
  - cluster
  - override /environment: isles_ddp_cluster
  - override /distribution: ddp
  - override /optimizer: adamw_75e5lr_wd00
  - override /model: medsegdiff_256_4l_32c_6x4a_128t_1btl_medium_simple
  - override /loss: multitask_equal
  - override /augmentation: aggressive_2d
  - override /training: train_500Kms_ampbfloat16
  - override /scheduler: warmup_cosine_10Ksteps
  - override /diffusion: openai_ddim_50steps
  - override /logging: ddim_50steps
  - override /validation: default

environment:
  dataset:
    train_batch_size: 64
    num_train_workers: 24
  training:
    output_root: '/mnt/outputs/medsegdiff_500K_64b_4gpu_ddp_210226/'

