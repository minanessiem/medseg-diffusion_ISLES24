# 4-GPU sweep config for multi-GPU training experiments
# Bundles common settings for the stability ablation study
#
# Usage: python3 -m scripts.slurm.single_job_runner --config-name cluster_4gpu_sweep --gpus 4 \
#   --overrides optimizer=adamw_5e5lr_wd00 training.gradient.clip_norm=1.0 scheduler.warmup_fraction=0.15

defaults:
  - cluster                              # base cluster environment
  - override /model: medsegdiff_256_4l_32c_6x4a_128t_1btl_medium_simple
  - override /loss: multitask_equal
  - override /augmentation: aggressive_2d
  - override /training: train_400Kms_ampbfloat16
  - override /scheduler: warmup_cosine_5pct
  - override /diffusion: openai_ddim_50steps
  - override /logging: ddim_50steps
  - override /validation: default # multigpu_128batch

# Override environment settings for 4-GPU training
environment:
  dataset:
    train_batch_size: 64
    num_valid_workers: 64
  training:
    output_root: '/mnt/outputs/medsegdiff_4gpu_sweep_120226/'


